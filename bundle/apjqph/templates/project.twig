{% extends "common.twig" %}

{% block name %}{{ name }}{% endblock %}
{% block nameTitle %}{{ name }}{% endblock %}

{% block style %}
    <link rel="stylesheet/less" type="text/css" href="res/res/project.less"/>
{% endblock %}

{% block js %}
    <script type="module" src="res/jquery.com/plugin/jquery-resizable.js"></script>
    <script type="module" src="res/res/project.js"></script>
{% endblock %}

{% block actions %}
    <button type="button" class="cm-save h-full flex px-2 py-2 cursor-pointer _hover:bg-gray-500 duration-75" title="{{ local.project.save }}" disabled1="disabled1">
        <i class="my-auto fas fa-save"></i>
    </button>
    <button type="button" class="cm-expand h-full flex px-2 py-2 cursor-pointer _hover:bg-gray-500 duration-75" title="{{ local.project.save }}" disabled1="disabled1">
        <i class="my-auto fas fa-expand"></i>
    </button>
{% endblock %}

{% block main %}
    {% import _self as _s %}

    <div id="cm-ide" class="cm-project bg-white _container mx-auto flex h-full" data-name="{{ name }}">
        
        <div class="cm-ide-direct w-11 flex flex-col bg-gray-600 text-white">
            <i class="cm-action-tree fas fa-sitemap p-3 hover:bg-gray-400 duration-75" title="{{ local.project.tree }}"></i>
            <i class="fas fa-user-friends p-3 hover:bg-gray-400 duration-75"></i>
        </div>
        
        <div class="cm-ide-tree bg-gray-700 text-white py-2 _px-3 duration-75 overflow-y-auto w-52">
            <li id="cm-node-template" class="cm-noselect" data-hid="%%hid%%" data-status="0">
                <div class="cm-line px-3 _truncate whitespace-nowrap" title="%%name%%">
                    <span class="cm-tab inline-block w-4"></span>
                    <i class="cm-folder cm-action-open fas fa-folder"></i>
                    <i class="cm-folder cm-action-close fas fa-folder-open"></i>
                    <i class="cm-file far fa-file"></i>
                    <span class="cm-text _text-xs px-1">%%name%%</span>
                </div>
            </li>
            {{ _s.tree(tree) }}
        </div>
        
        <div class="cm-splitter w-1"></div>
        {#<div class="flex-auto bg-green-500">332e3e3/</div>#}
        <div class="cm-ide-container flex-1 min-w-0 overflow-x-auto _flex-auto">
            <div>we'fkwe'fkwkefjqwjefjqwje;fqjwejfqwefjwefjjwefkjwe;lfjwfjejwefjw;ljef;ljwef;ljwelfjlwjeflkfew_890</div>
            {#
            <ul class="cm-tabs _overflow-x-auto _flex-nowrap _fixed">
                <li class="cm-tab">1111</li>
                <li class="cm-tab">2222</li>
                <li class="cm-tab">3333</li>
                <li class="cm-tab">4444</li>
                <li class="cm-tab">5555</li>
                <li class="cm-tab">6666</li>
                <li class="cm-tab">7777</li>
                <li class="cm-tab">8888</li>
                <li class="cm-tab">9999</li>
                <li class="cm-tab">0000</li>
                
                <li class="cm-tab">1111</li>
                <li class="cm-tab">2222</li>
                <li class="cm-tab">3333</li>
                <li class="cm-tab">4444</li>
                <li class="cm-tab">5555</li>
                <li class="cm-tab">6666</li>
                <li class="cm-tab">7777</li>
                <li class="cm-tab">8888</li>
                <li class="cm-tab">9999</li>
                <li class="cm-tab">0000</li>
                
            </ul>
            
            <div class="cm-aces">
                <div>c_1111</div>
                <div>c_2222</div>
                <div>c_3333</div>
                <div>c_4444</div>
            </div>
            #}
        </div>
    </div>
    <div id="cm-list" class="inset-0 absolute flex bg-gray-400 bg-opacity-70 cm-noselect">
        <div class="cm-container flex flex-col w-max mx-auto mt-10 border border-gray-300 overflow-y-auto bg-gray-100">
            
            <div class="cm-element">qweqwe</div>
            <div class="cm-element">ertert</div>
            <div class="cm-element">tryrty</div>
            <div class="cm-element">yutyuty wefewf weew ewew 90</div>
            <div class="cm-element">111</div>
            <div class="cm-element">222</div>
            <div class="cm-element">333</div>
            <div class="cm-element">444</div>
            
        </div>
    </div>
{% endblock %}

{% block current %}
    <div class="cm-current flex-grow flex min-w-0">
        <div class="cm-container my-auto ml-auto whitespace-nowrap _flex-grow min-w-0 truncate text-left _overflow-x-hidden">qqqqqq 22 33</div>
        <i class="fas fa-caret-left ml-3 w-6 text-xl my-auto mr-auto text-center cursor-pointer duration-150"></i>
    </div>

    {#<div id="cm-tabs" class="flex flex-grow min-w-0">
        <i class="fas fa-caret-left w-6 text-3xl my-auto text-center cursor-pointer"></i>
        <div class="cm-noselect cm-container flex-grow flex min-w-0 overflow-x-hidden">
            <div class="cm-tab">qweqwe</div>
            <div class="cm-tab">ertert</div>
            <div class="cm-tab">tryrty</div>
            <div class="cm-tab">yutyuty wefewf weew ewew 90</div>
            <div class="cm-tab">111</div>
            <div class="cm-tab">222</div>
            <div class="cm-tab">333</div>
            <div class="cm-tab">444</div>
        </div>
        <i class="fas fa-caret-right w-6 text-3xl my-auto text-center cursor-pointer"></i>
    </div>#}
{% endblock %}

{% macro node(node) %}
    {% import _self as _s %}

    <li data-hid="{{ node.hid }}"
        {% if node.type=='folder' %}
            data-status="{% if node.children is defined and node.children|length %}1{% else %}0{% endif %}"
        {% endif %}
    >
        <div class="cm-line px-3 _truncate whitespace-nowrap" title="{{ node.names }}">
            {% for i in range(0,node.level) if i>0 %}<span class="cm-tab inline-block w-4"></span>{% endfor %}
            {% if node.type == 'folder' %}
                <i class="cm-folder cm-action-open fas fa-folder"></i>
                <i class="cm-folder cm-action-close fas fa-folder-open"></i>
            {% else %}
                <i class="cm-file far fa-file"></i>
            {% endif %}
            <span class="cm-text _text-xs px-1">{{ node.name }}</span>
        </div>

        {% if node.children is defined %}
            {{ _s.tree(node.children,1) }}
        {% endif %}
    </li>
{% endmacro %}

{% macro tree(nodes,isNotTop) %}
    {% import _self as _s %}

    <ul{% if not isNotTop %} class="cm-root cm-noselect"{% endif %}>
        {% for node in nodes %}
            {{ _s.node(node) }}
        {% endfor %}

        {#
        {% for node in nodes2 %}
            <li data-hid="{{ node.hid }}"
                {% if node.type=='folder' %}
                    data-status="{% if node.children is defined and node.children|length %}1{% else %}0{% endif %}"
                {% endif %}
            >
                <div class="cm-line px-3 truncate" title="{{ node.name }}">
                    {% for i in range(0,node.level) if i>0 %}<span class="inline-block w-4"></span>{% endfor %}

                    {% if node.type == 'folder' %}
                        <i class="cm-action cm-action-open fas fa-folder"></i>
                        <i class="cm-action cm-action-close fas fa-folder-open"></i>
                    {% else %}
                        <i class="far fa-file"></i>
                    {% endif %}

                    <span class="_text-xs px-1">{{ node.name }}</span>
                </div>

                {% if node.children is defined %}
                    {{ _s.tree(node.children,1) }}
                {% endif %}
            </li>
        {% endfor %}
        #}
    </ul>
{% endmacro %}
